---
import type { GetStaticPaths } from 'astro';
import { getCollection, render } from 'astro:content';
import { Image } from 'astro:assets';
import MainLayout from '../../layouts/MainLayout.astro';
import Section from '../../components/ui/Section.astro';
import Badge from '../../components/ui/Badge.astro';
import Button from '../../components/ui/Button.astro';

export const getStaticPaths = (async () => {
  const pariwisataEntries = await getCollection('pariwisata');
  return pariwisataEntries.map((entry) => ({
    params: { slug: entry.id },
    props: { entry },
  }));
}) satisfies GetStaticPaths;

const { entry } = Astro.props;
const { Content } = await render(entry);
const { title, description, location, facilities, activities, entrance, openingHours, image, imageAlt } = entry.data;
---

<MainLayout title={title} description={description} image={image.src}>

  <Section background="white">
    <div class="mx-auto max-w-5xl">
      <nav class="mb-6 text-sm text-gray-500">
        <a href="/" data-astro-prefetch class="hover:underline">Beranda</a>
        <span class="mx-2">›</span>
        <a href="/pariwisata" data-astro-prefetch class="hover:underline">Pariwisata</a>
        <span class="mx-2">›</span>
        <span class="text-gray-700">{title}</span>
      </nav>

      <h1 class="mb-4 text-3xl font-bold text-gray-900 md:text-4xl">
        {title}
      </h1>

      <div class="mb-6 flex items-start text-gray-600">
        <i class="fas fa-map-marker-alt mr-2 mt-1 text-red-500"></i>
        <span>{location}</span>
      </div>

      <div class="mb-8 aspect-video overflow-hidden rounded-lg">
        <Image src={image} alt={imageAlt} class="h-full w-full object-cover" />
      </div>

      <div
        class="prose prose-lg mb-8 max-w-none prose-headings:text-gray-900 prose-headings: prose-p:text-gray-700 prose-p:"
      >
        <Content />
      </div>

      <div class="grid grid-cols-1 gap-6 md:grid-cols-2">
        {
          facilities && facilities.length > 0 && (
            <div class="rounded-lg border border-gray-200 bg-gray-50 p-6">
              <h3 class="mb-4 flex items-center gap-2 text-xl font-bold text-gray-800">
                <i class="fas fa-concierge-bell text-blue-600" />
                Fasilitas
              </h3>
              <ul class="list-inside list-disc space-y-2 text-gray-600">
                {facilities.map((facility) => (
                  <li>{facility}</li>
                ))}
              </ul>
            </div>
          )
        }

        {
          activities && activities.length > 0 && (
            <div class="rounded-lg border border-gray-200 bg-gray-50 p-6">
              <h3 class="mb-4 flex items-center gap-2 text-xl font-bold text-gray-800">
                <i class="fas fa-hiking text-green-600" />
                Aktivitas
              </h3>
              <ul class="list-inside list-disc space-y-2 text-gray-600">
                {activities.map((activity) => (
                  <li>{activity}</li>
                ))}
              </ul>
            </div>
          )
        }
      </div>

      <div class="mt-6 flex flex-wrap gap-4">
        <Badge variant="success" size="lg">
          <i class="fas fa-ticket-alt mr-2"></i>
          {entrance}
        </Badge>
        <Badge variant="info" size="lg">
          <i class="fas fa-clock mr-2"></i>
          {openingHours}
        </Badge>
      </div>

      <div class="mt-10 border-t border-gray-200 pt-6">
        <a
          href="/pariwisata"
          data-astro-prefetch
          class="inline-flex items-center gap-2 font-semibold text-blue-600 hover:underline"
        >
          <i class="fas fa-arrow-left"></i>
          Kembali ke Daftar Destinasi
        </a>
      </div>
    </div>
  </Section>
</MainLayout>
