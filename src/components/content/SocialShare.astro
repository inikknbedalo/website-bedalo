---
interface Props {
  title: string;
  url: string;
}

const { title, url } = Astro.props;
---

<div class="rounded-lg border border-gray-200 bg-gray-50 p-6">
  <h3 class="mb-4 text-lg font-bold text-gray-900">Bagikan Artikel Ini</h3>
  <div class="flex flex-wrap gap-3">
    <button
      data-share="facebook"
      class="flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 text-white transition-colors hover:bg-blue-700"
      aria-label="Bagikan ke Facebook"
    >
      <i class="fab fa-facebook-f"></i>
      <span>Facebook</span>
    </button>

    <button
      data-share="twitter"
      class="flex items-center gap-2 rounded-lg bg-sky-500 px-4 py-2 text-white transition-colors hover:bg-sky-600"
      aria-label="Bagikan ke Twitter"
    >
      <i class="fab fa-twitter"></i>
      <span>Twitter</span>
    </button>

    <button
      data-share="whatsapp"
      class="flex items-center gap-2 rounded-lg bg-green-500 px-4 py-2 text-white transition-colors hover:bg-green-600"
      aria-label="Bagikan ke WhatsApp"
    >
      <i class="fab fa-whatsapp"></i>
      <span>WhatsApp</span>
    </button>

    <button
      data-share="copy"
      class="flex items-center gap-2 rounded-lg bg-gray-600 px-4 py-2 text-white transition-colors hover:bg-gray-700"
      aria-label="Salin tautan"
    >
      <i class="fas fa-link"></i>
      <span data-copy-text="Salin Link">Salin Link</span>
    </button>
  </div>
  <div
    id="copy-feedback"
    class="mt-3 hidden rounded bg-green-100 px-3 py-2 text-sm text-green-700"
  >
    <i class="fas fa-check-circle"></i> Tautan disalin!
  </div>
</div>

<script is:inline define:vars={{ title, url }}>
  document.querySelectorAll('[data-share]').forEach((button) => {
    button.addEventListener('click', () => {
      const type = button.getAttribute('data-share');
      const fullUrl = `${window.location.origin}${url}`;
      const text = encodeURIComponent(title);
      
      let shareUrl = '';
      
      switch (type) {
        case 'facebook':
          shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(fullUrl)}`;
          break;
        case 'twitter':
          shareUrl = `https://twitter.com/intent/tweet?url=${encodeURIComponent(fullUrl)}&text=${text}`;
          break;
        case 'whatsapp':
          shareUrl = `https://wa.me/?text=${text}%20${encodeURIComponent(fullUrl)}`;
          break;
        case 'copy':
          navigator.clipboard.writeText(fullUrl).then(() => {
            const feedback = document.getElementById('copy-feedback');
            feedback.classList.remove('hidden');
            setTimeout(() => {
              feedback.classList.add('hidden');
            }, 3000);
          });
          return;
      }
      
      if (shareUrl) {
        window.open(shareUrl, '_blank', 'width=600,height=400');
      }
    });
  });
</script>
